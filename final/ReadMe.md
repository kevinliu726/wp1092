# Group 27 祖傳三代改良版21點 疫情在家和小夥伴同樂的賭博遊戲
## Group Member:
台大資工四 B06902042 劉愷為
台大資工四 B06902061 林采鋒

## Project Info
## Project Info
Deployed連結：https://blackjack-lk.herokuapp.com/
Demo影片連結：https://youtu.be/d_yG5IhgKoI
GitHub連結：https://github.com/kevinliu726/wp1092

## 介紹
這次一個可以和朋友線上即時對戰的21點遊戲。

## 使用/操作方式
遊戲進行規則在規則頁面中有詳細的解說，在此不多贅述

## 使用套件、框架、程式碼
Frontend: React
Backend: Node.js、GraphQL
Database: MongoDB
Other: Material-UI、Apollo、uuid、antd

## 心得
### 劉愷為
這次的專案，我主要負責前端的部分。思考了很久之後，我們決定做自己會有興趣的服務。剛剛好在思考主題的時候疫情爆發，而我們也都無法和朋友們見面。平時我們晚上會聚再一起玩德州鋪克和21點，在網路上找不到合適的免費21點遊戲，因此就決定自己來開發一個。透過這次Project，真的是學習到了很多新東西。為了讓介面好看，我慢慢的摸索使用 Material UI 的方法。花最多的時間就是在調整顏色、位置等等，明明就已經設定好了，然而畫面卻沒有顯示出想要的東西。一查才發現可能是有某一個開關沒開或是在錯誤的地方設定css等。在此特別感謝組員林采鋒，因為我這一週開始上班，因此一天有大半的時間都無法撰寫。我已經有提早開始，然而還是有點小趕不上。常常起床上班時，會發現他都還沒睡！如果沒有他，我們這個專題可能會難產。

### 林采鋒
會有這個服務的誕生，主要還是歸功於我有一群好賭的朋友。而這款我家祖傳三代的 21 點，也在朋友圈掀起一陣旋風。本以為 21 點已經是狀態簡單的多人遊戲，但其實細思級恐，搭配我們家的特殊倍率玩法，若還要支援離座、回座的功能，其實也不簡單。我負責的後端主要處理各玩家之間的狀態，要寫的乾淨漂亮，還真的不簡單。常常以為把所有狀況都考慮好了，卻總是會戳到一些怪 bug。加上後來有支援組員一些前端的問題，例如 react-router 的轉移，還有玩家按了上一頁卻還是能進房看牌的問題，深深覺得要做好一個服務其實沒那麼簡單。如果有來生，我不會再讀資工系。

## 其他說明
原本為了避免有人掛機導致遊戲無法進行，有實作一個Timer。然而發現在多人同時進行的時候，有可能會發生race condition導致遊戲狀態出問題，因此最後選擇拿掉此功能

## 功能描述
在尚未登入前/登出之後，無法透過輸入網址的方式查看Menu、Lobby、Game頁面，皆會被重導至登入畫面

## Login
- Username:
    - 若為空白，將跳出錯誤訊息
    - 若使用者名稱不存在，將跳出錯誤訊息
- Password:
    - 點旁邊的眼睛按鈕，可顯示密碼，再次點選則會隱藏密碼
    - 若為空白，將跳出錯誤訊息
    - 若密碼與使用者名稱對不上，將跳出錯誤訊息
- Login: 確認帳密之後，將會跳轉至Menu頁面
- Create Account: 跳轉至Register頁面
## Register
- Username:
    - 若為空白，將跳出錯誤訊息
    - 若使用者名稱已存在，將跳出錯誤訊息
- Password/Confirm Password:
    - 點旁邊的眼睛按鈕，可顯示密碼，再次點選則會隱藏密碼
    - 若為空白，將跳出錯誤訊息
    - 若密碼與確認密碼對不上，將跳出錯誤訊息
- Register: 確認輸入的資料沒問題後，將會跳轉至Menu頁面
- Create Account: 跳轉至Register頁面
### Menu
- Public: 進入Public Lobby，將會列出所有不需密碼即可進入的房間
- Private: 進入Private Lobby，將會列出所有需要密碼即可進入的房間
- Setting: 進行密碼的修改
- History: 查看歷史對戰紀錄(點進去之後會看到所參與過的房間名稱，再點進房間則可以看到該房間中自己所有的對戰紀錄，包含每一次的牌型、下注金額以及最終的結果)
- Rules: 查看我們遊戲的規則
- Logout: 登出遊戲
### Lobby
- Create: 可以創建房間，在此輸入房間名稱、下注的上下限(若無輸入，下限自動設為1、上限設為2,147,483,647)、需要用到的牌組數目。若在Private Lobby則會需要輸入該房間密碼。
    - 房間名稱及密碼皆不可為空白，若為空白則會跳出錯誤訊息。
    - 上下界必須為正整數且上界需大於等於下界，若違反則會跳出對應的錯誤訊息
- Search: 可以輸入想要查詢的房間名稱，將會即時列出所有包含輸入字串的房間
- Room: 點選房間之後，將會跳轉至Game頁面。若為Private Room則會需要輸入密碼才能進入
    - 密碼輸入錯誤或是空白皆會跳出錯誤訊息
- Back Button: 會跳轉回Menu頁面

## Game
- LEAVE: 
    - 玩家：從與莊家對戰完到下一把莊家按下START之前將會顯示，按下即可離開遊戲房間。
    - 莊家：當按下END之後會顯示。若莊家離開房間，房間會關閉，其他在房間內的人會收到房間已關閉的通知。
- AWAY: 
    - 只有玩家會顯示此按鈕
    - 從與莊家對戰完到下一把莊家按下START之前將會顯示，按下將會顯示暫時離開(座位保留)
- BACK:
    - 只有玩家會顯示此按鈕 
    - 按下AWAY後，在每一把之間會顯示，按下即可重新返回遊戲
- BET: 
    - 跳出BET畫面時，須在旁邊的格子輸入下注金額。若輸入金額不在上下界之間，會跳出錯誤訊息
- SIT: 
    - 只有玩家會顯示此按鈕 
    - 畫面上會有11個位置可以選擇，當點選其中一個座位之後，整個座位圈會將所點選的座位旋轉至最下面的那一格。在莊家還有沒開始之前，皆可在空座位隨意切換。


## 如何在local安裝及測試

1. Install
``` bash
npm install
```
2. Build
``` bash
npm run build
```
3. 在 `.env` 設定MongoDB URL
  ``` bash
  cp .env.defaults .env
  # fill in the MONGO url
  ```
4. 啟動
```bash
npm start
```


## Contribution
1. 劉愷為 B06902042 UI設計、前端、前後端串接
2. 林采鋒 B06902061 後端、前後端串接、Game遊戲進行邏輯、Deploy
